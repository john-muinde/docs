---
title: "Webhook Notifications"
description: "Receive real-time notifications about transaction status updates and other events."
---

Kotani Pay sends webhook notifications to inform your application about key lifecycle events—transaction status changes, payment confirmations, compliance updates, and scheduled system announcements. Use these callbacks to drive your automations instead of polling for status.

## Supported Events

Configure one webhook endpoint per environment from the dashboard and opt in to any combination of events:

- **Transaction Status Updates** – Deposit, withdrawal, or transfer status changes (e.g., `PENDING` → `COMPLETED`)
- **Payment Confirmations** – Real-time acknowledgements when a payment settles on- or off-chain
- **KYC Status Changes** – Triggers when a customer's verification outcome changes
- **System Events** – Low-volume operational notices and maintenance alerts

### Event Types

The following event types are available:

```typescript
// Deprecated - kept for backward compatibility
TRANSACTION_STATUS_UPDATED = 'transaction.status.updated',

// Specific transaction type events
TRANSACTION_DEPOSIT_STATUS_UPDATED = 'transaction.deposit.status.updated',
TRANSACTION_WITHDRAWAL_STATUS_UPDATED = 'transaction.withdrawal.status.updated',
TRANSACTION_ONRAMP_STATUS_UPDATED = 'transaction.onramp.status.updated',
TRANSACTION_OFFRAMP_STATUS_UPDATED = 'transaction.offramp.status.updated',

// Payment events
PAYMENT_CONFIRMED = 'payment.confirmed',

// KYC events
KYC_STATUS_CHANGED = 'kyc.status.changed',

// System events
SYSTEM_EVENT = 'system.event',
```

## Payload Format

Webhooks are sent as HTTP `POST` requests with a JSON payload. The request body includes the event name, data payload, and a convenience copy of the signature. The canonical signature is delivered in the `X-Kotani-Signature` header.

```json
{
  "event": "transaction.deposit.status.updated",
  "data": {
    "referenceId": "ABC123",
    "status": "SUCCESSFUL",
    "timestamp": "2025-01-01T00:00:00Z"
  },
  "signature": "sha256=abc123..."
}
```

> **Tip:** The payload's `signature` field is provided for quick sanity checks, but the header is the source of truth for verification.

## Verifying Signatures

Every payload is signed with your dashboard-configured webhook secret. Validate the signature before acting on the event:

1. Read the request body as a **raw string** before parsing or mutating it.
2. Compute an HMAC-SHA256 digest: `sha256=HMAC(secret, rawBody)`.
3. Compare the digest with the `X-Kotani-Signature` header using a timing-safe comparison.

### Node.js helper

```ts
import crypto from "crypto";

export function verifyWebhook({ secret, rawBody, headerSignature }: {
  secret: string;
  rawBody: string | Buffer;
  headerSignature: string;
}) {
  const normalizedBody = Buffer.isBuffer(rawBody)
    ? rawBody
    : Buffer.from(rawBody, "utf8");

  const computed =
    "sha256=" +
    crypto.createHmac("sha256", secret).update(normalizedBody).digest("hex");

  try {
    return crypto.timingSafeEqual(
      Buffer.from(computed),
      Buffer.from(headerSignature.trim())
    );
  } catch {
    return false;
  }
}
```

## Configuring Webhooks

1. Log into the Kotani Pay dashboard.
2. Navigate to **Settings → Webhooks**.
3. Provide a publicly reachable HTTPS URL.
4. Select the events you want to subscribe to.
5. Copy or generate a signing secret and store it securely (e.g., an environment variable).
6. Save your changes.

You can rotate the secret at any time; remember to update your verification logic before applying the new secret in production.
